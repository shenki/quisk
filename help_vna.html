
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="description" content="Documentation for Quisk VNA"><meta name="author" content="James C. Ahlstrom"><meta name="keywords" content="quisk, vna, vector network analyzer, ham radio">
<title>QUISK Help File</title>
</head><body>
<h3>
Quisk VNA Help (February 2012)
</h3>


<p>This is the Help file for Quisk VNA, a program that turns the
Quisk2010 and HiQSDR transceiver hardware into a Vector Networ Analyzer
(VNA).
This
Help appears when you press the Help button. Quisk is written by Jim
Ahlstrom, N2ADR,
www.james.ahlstrom.name. Mail to jahlstr at gmail.com.&nbsp; To run the
Quisk VNA program, use "python quisk_vna.py" or set up a
shortcut.&nbsp; This program only works with my hardware that is based
on UDP.&nbsp; It does not work with SoftRock hardware.
<br>
</p>
<p>You need to update your firmware to Version 1.3 or later.&nbsp; The
new firmware locks the phase of the RF output to the phase of the RF
detector.&nbsp; There is a time delay in the path, but this is removed
by the calibration proceedure.&nbsp; The calibration graphs will show a linear phase change with frequency due to this delay.
<br>
</p>
<p>There are two ways to use your hardware.&nbsp; You could connect the
RF output through attenuators, through a device under test and then
back to the RF input.&nbsp; This is called transmission mode.&nbsp; It is
used to plot the response of filters and to measure the electrical
length of cables.&nbsp; Or you could connect the RF input and output to
a resistive return loss bridge.&nbsp; This is called reflection mode.&nbsp; It is
used to measure SWR and impedance.&nbsp; You must choose a mode and
calibrate for that mode and hardware before you take any data.</p>
<p>The hardware generates RF output only when one of the "Calibrate"
buttons or the "Run" button is turned on.&nbsp; When calibrating, press
the calibration button and wait for the screen to show a steady
trace.&nbsp; Then press it again to turn the RF off before changing
cables.&nbsp; The calibration routines save data every 15 kHz from zero
to sixty megahertz.&nbsp; You can change the measurement frequency span
at any time without recalibration.&nbsp; Although you can set a
frequency span up to sixty megahertz, my original hardware has a low
pass filter cutoff of 35 megahertz, so the upper frequency range is
smaller and will appear noisy.</p>
<p>Since the transmit and receive frequencies are equal, the data is at
DC, and is averaged and effectively low pass filtered.&nbsp; This
provides immunity from interference when measuring an antenna.
<br>
</p>
<p></p>
<h3 id="g0.0.1">Input Protection </h3>
Do not connect the RF output to the RF input without inserting
attenuators.&nbsp; The output will overload the input and result in
clipping in the ADC and possible damage.&nbsp; If your device under
test is an amplifier be especially careful to add additional
attenuation to avoid damage.&nbsp; Add enough attenuation to avoid
clipping, but not so much that you lose dynamic range.&nbsp; The
calibration screens show the ADC level.&nbsp; These attenuators also
help to stabilize the input and output impedance and increase
accuracy.&nbsp; I use the HAT series of attenuators from Mini-Circuits.
<br>


<h3 id="g0.0.2">Thansmission Mode
</h3>

You must perform a calibration before you can take data.&nbsp; First
set the mode to "Trans" and leave it there.&nbsp; Connect attenuators
and a cable between the RF input and output.&nbsp; Press "Cal Remove"
to remove any prior calibration data, then press "Cal Short".&nbsp; The
screeen will show the voltage and phase at the input.&nbsp; You can
remove the cable and press "Cal Open" to correct for signal leakage,
but this is optional.&nbsp; With the cable connected, press "Run" and
you should see a flat line at zero dB level and zero phase.&nbsp; Now
insert your test device in series.&nbsp; The test device could be a
filter, an amplifier (be careful) or an additional length of
cable.&nbsp; You can press "Run" again to stop taking data, and the
most recent data will be retained.
<br>

<br>
<h3 id="g0.0.3">Reflection Mode
</h3>
This mode is used with a resistive return loss bridge.&nbsp;
Connnect the RF
output to the generator terminal, and the RF input to the detector
terminal.&nbsp; Use attenuators as required.&nbsp;&nbsp; You must
perform a calibration before you can take data.&nbsp; First set the
mode to "Refl" and leave it there.&nbsp; Press "Cal Remove" to remove
any
prior calibration data.&nbsp; Connect an open circuit (or nothing) to
the impedance
terminal of the bridge, and then press "Cal Open".&nbsp; Connect a
short circuit to the bridge, and then press "Cal Short".&nbsp; Connect
a 50 ohm termination to the bridge and then press "Cal Load".
<br>

<br>
If you do not have a set of Open/Short/Load standards, you can just
leave the connector open and use "Cal Open" alone.&nbsp; Using "Cal
Load" will attempt a baseline correction, but this requires all three
calibrations be used.&nbsp; So your calibration options are: Open; both
Open and Short; or all three.
<br>

<br>
Connect a 50 ohm termination to the bridge, and
press "Run".&nbsp; The graph will show the magnitude and phase of the
reflection coefficient, and the return loss is the drop in magnitude
below zero dB.&nbsp; Ideally your bridge will have a directivity of 30
dB or more.&nbsp; The phase may be noisy if the magnitude is very
small.&nbsp; Now connect an
unknown impedance to the bridge; for example, an antenna.&nbsp; The
graph will plot the return loss, reflection coefficient and SWR.&nbsp;
The status line will display the impedance and the equivalant
capacitance or inductance.
<br>

<br>
You can attach any impedance, such as an unknown capacitor or inductor,
and read the value directly.&nbsp; The value may seem to vary with
frequeny due to stray inductance, variation of permeability with
frequency, and bridge imperfections; so choose a reference frequency
wisely.&nbsp; Remember that the bridge measures the impedance relative
to fifty ohms, so accuracy suffers if the impedance is outside the
range of 5 to 500 ohms or so.
<br>
<h3 id="g0.0.4">Fun</h3>
In transmission mode, add an extra length of cable and see the phase
change.&nbsp; When the phase change is ninety degrees, that is a
quarter wave.&nbsp; The effect of velocity factor is included, and can
be measured.&nbsp; Use a bare wire (with attenuators) as the test
fixture, and then add a ferrite bead to the wire to measure its
properties.&nbsp; Insert a filter to see its response.
<br>

<br>
In reflection mode, measure your antenna from zero to sixty
megahertz.&nbsp; If it is a dipole, you will see the drop in SWR at its
third harmonic.&nbsp; Add a cable to the bridge to see its impedance at
a quarter and half wave length.&nbsp; Measure the length of your
transmission line by replacing your antenna with a 100 ohm
resister.&nbsp; The bridge will read 100 ohms at multiples of a half
wavelength.&nbsp; If you short out your antenna at the far end of your
transmission line, the bridge will read zero at half wavelengths, and
infinity at quarter wavelengths.
<br>
</body>
</html>
